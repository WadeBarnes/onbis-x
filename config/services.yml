issuers:
  onbis:
    name: Ministry of Government and Consumer Services
    abbreviation: MGCS
    email: 393 University Avenue, Suite 200, Toronto, ON  M5G 2M2
    url: http://www.ontario.ca

    connection:
      type: TheOrgBook
      api_url: $TOB_API_URL
      sign_target: false

    wallet:
      seed: $WALLET_SEED_ONBIS
      type: $WALLET_TYPE
      params:
        storage_config:
          url: "$POSTGRESQL_WALLET_HOST:$POSTGRESQL_WALLET_PORT"
      access_creds:
        key: $WALLET_ENCRYPTION_KEY
        storage_credentials:
          account: $POSTGRESQL_WALLET_USER
          password: $POSTGRESQL_WALLET_PASSWORD
          admin_account: ${POSTGRESQL_WALLET_ADMIN_USER:-postgres}
          admin_password: $POSTGRESQL_WALLET_ADMIN_PASSWORD
        key_derivation_method: ARGON2I_MOD

    credential_types:
      - description: Business Registration
        schema: registration.onbis.gov.on.ca
        issuer_url: $APPLICATION_URL_REGISTRATION
        topic:
          source_id:
            input: registration_id
            from: claim
          type:
            input: registration
            from: value
        mapping:
          - model: name
            fields:
              text:
                input: entity_name
                from: claim
              type:
                input: entity_name
                from: value
          - model: category
            fields:
              value:
                input: entity_status
                from: claim
              type:
                input: topic_status
                from: value
          - model: category
            fields:
              value:
                input: entity_type
                from: claim
              type:
                input: topic_type
                from: value
          - model: category
            fields:
              value:
                input: registration_date
                from: claim
              type:
                input: topic_registration_date
                from: value
          - model: category
            fields:
              value:
                input: entity_status_effective
                from: claim
              type:
                input: topic_status_effective_date
                from: value

      - description: Business Address
        schema: address.onbis.gov.on.ca
        issuer_url: $APPLICATION_URL_ADDRESS
        topic:
          -
            source_id:
              input: registration_id
              from: claim
            type:
              input: registration
              from: value
        cardinality_fields:
          - address_type
        mapping:
          - model: address
            fields:
              addressee:
                input: addressee
                from: claim
              civic_address:
                input: civic_address
                from: claim
              city:
                input: municipality
                from: claim
              province:
                input: province
                from: claim
              postal_code:
                input: postal_code
                from: claim
              country:
                input: country
                from: claim
              type:
                input: address_type
                from: claim
              effective_date:
                input: effective_date
                from: claim

      - description: Relationship
        schema: relationship.onbis.gov.on.ca
        issuer_url: $APPLICATION_URL_RELATIONSHIP
        topic:
          related_source_id:
            input: associated_registration_id
            from: claim
          related_type:
            input: registration
            from: value
          source_id:
            input: registration_id
            from: claim
          type:
            input: registration
            from: value